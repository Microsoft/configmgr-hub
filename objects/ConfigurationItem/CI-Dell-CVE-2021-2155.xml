<?xml version="1.0" encoding="utf-8"?>
<model xmlns="http://www.w3.org/2008/03/sml-if">
  <identity>
    <name>ScopeId_96966290-7C86-45F7-9623-B88938BD645D/OperatingSystem_bdf0dffe-e482-4583-93a3-18d3fc6767db</name>
    <version xmlns="">3</version>
  </identity>
  <instances>
    <document documentType="4">
      <docinfo>
        <WmiClasses xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2008/05/01/CIManifest">
          <WmiClass WmiNamespace="root\CCM\CIModels">ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50</WmiClass>
        </WmiClasses>
        <ConfiguartionPointAccessors xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2008/05/01/CIManifest">
          <ConfigurationPointAccessor DigestModelName="ScopeId_96966290-7C86-45F7-9623-B88938BD645D/OperatingSystem_bdf0dffe-e482-4583-93a3-18d3fc6767db" DigestVersion="3" SettingLogicalName="ScriptSetting_bffabb8f-4a67-4f41-9be6-c1099216bb50" SettingSourceType="Script">
            <ExistantialAccessor>
              <VariableSelector>wmi::root::CCM::CIModels::ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50.allInstances()</VariableSelector>
            </ExistantialAccessor>
            <ValueAccessor>
              <ContextSelector>wmi::root::CCM::CIModels::ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50.allInstances()</ContextSelector>
              <VariableSelectors>
                <VariableSelector>Value</VariableSelector>
              </VariableSelectors>
            </ValueAccessor>
          </ConfigurationPointAccessor>
        </ConfiguartionPointAccessors>
      </docinfo>
      <data>#pragma namespace("\\\\.\\root\\CCM\\CIModels")
[
Dynamic: ToInstance,
InPartition{"local-system", "local-user"},
Provider("ScriptProvider"): ToInstance
]
class ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50
{
	[key] string InstancePath;
	boolean Value;
};

</data>
    </document>
    <document documentType="5">
      <docinfo>
        <WmiInstances xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2008/05/01/CIManifest">
          <WmiInstance WmiNamespace="root\microsoft\policyplatform\Documents\Local">PolicyPlatform_Policy.Name="ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Platform_PolicyDocument",Authority="System Center Configuration Manager",Revision=3</WmiInstance>
          <WmiInstance WmiNamespace="root\microsoft\policyplatform\Documents\Local">PolicyPlatform_Policy.Name="ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Discovery_PolicyDocument",Authority="System Center Configuration Manager",Revision=3</WmiInstance>
          <WmiInstance WmiNamespace="root\microsoft\policyplatform\Documents\Local">PolicyPlatform_Policy.Name="ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Configuration_PolicyDocument",Authority="System Center Configuration Manager",Revision=3</WmiInstance>
        </WmiInstances>
        <ConfiguartionPointAccessors xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2008/05/01/CIManifest">
          <ConfigurationPointAccessor DigestModelName="ScopeId_96966290-7C86-45F7-9623-B88938BD645D/OperatingSystem_bdf0dffe-e482-4583-93a3-18d3fc6767db" DigestVersion="3" SettingLogicalName="ScriptSetting_bffabb8f-4a67-4f41-9be6-c1099216bb50" SettingSourceType="Script">
            <ExistantialAccessor>
              <VariableSelector>wmi::root::CCM::CIModels::ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50.allInstances()</VariableSelector>
            </ExistantialAccessor>
            <ValueAccessor>
              <ContextSelector>wmi::root::CCM::CIModels::ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50.allInstances()</ContextSelector>
              <VariableSelectors>
                <VariableSelector>Value</VariableSelector>
              </VariableSelectors>
            </ValueAccessor>
          </ConfigurationPointAccessor>
        </ConfiguartionPointAccessors>
      </docinfo>
      <data>#pragma namespace("\\\\.\\root\\microsoft\\PolicyPlatform\\Documents\\Local")

instance of PolicyPlatform_Policy
{
	Authority = "System Center Configuration Manager";
	CreationDate = "99991231235959.999999+000";
	ExportedRuleName = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Platform_PolicyDocument";
	Name = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Platform_PolicyDocument";
	Revision = 3;
	Rules =
	{
		instance of PolicyPlatform_Rule
		{
			Conditions =
			{
				instance of PolicyPlatform_RuleReference
				{
					RuleName = "Platform_Rule_ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3";
				}
			};
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Invariant = "true";
				Variables = NULL;
			};
			Name = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Platform_PolicyDocument";
		}
		,
		instance of PolicyPlatform_Rule
		{
			Conditions = NULL;
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Invariant = "((true))";
				Variables = NULL;
			};
			Name = "Platform_Rule_ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3";
		}
	};
};

#pragma namespace("\\\\.\\root\\microsoft\\PolicyPlatform\\Documents\\Local")

instance of PolicyPlatform_Policy
{
	Authority = "System Center Configuration Manager";
	CreationDate = "99991231235959.999999+000";
	ExportedRuleName = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Discovery_PolicyDocument";
	Name = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Discovery_PolicyDocument";
	Revision = 3;
	Rules =
	{
		instance of PolicyPlatform_Rule
		{
			Conditions =
			{
				instance of PolicyPlatform_RuleReference
				{
					RuleName = "Discovery_Rule_ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3";
				}
			};
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Invariant = "true";
				Variables = NULL;
			};
			Name = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Discovery_PolicyDocument";
		}
		,
		instance of PolicyPlatform_Rule
		{
			Conditions =
			{
				instance of PolicyPlatform_PolicyReference
				{
					Authority = "System Center Configuration Manager";
					PolicyName = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Platform_PolicyDocument";
				}
			};
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Invariant = "((($GLOBAL_Platform_Settings_Win32_OperatingSystem_Version_Version__Value &gt;= Version{'10.0'}) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_OSType__Value = 18) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_ProductType__Value = 1) and ($GLOBAL_Platform_Settings_CCM_OperatingSystem_Architecture__Value.equalsIgnoreCase(@'ARM64')) and (not( $GLOBAL_Platform_Settings_Win32_OperatingSystem_OSCaption__Value.equals(@'not_a_valid_os_caption', Set { StringComparison::ignoreCase } ) )))) or ((($GLOBAL_Platform_Settings_Win32_OperatingSystem_Version_Version__Value &gt;= Version{'10.0'}) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_OSType__Value = 18) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_ProductType__Value = 3) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_OperatingSystemSKU__Value = 175))) or ((($GLOBAL_Platform_Settings_Win32_OperatingSystem_Version_Version__Value &gt;= Version{'10.0'}) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_OSType__Value = 18) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_ProductType__Value = 1) and ($GLOBAL_Platform_Settings_CCM_OperatingSystem_Architecture__Value.equalsIgnoreCase(@'AMD64')) and (not( $GLOBAL_Platform_Settings_Win32_OperatingSystem_OSCaption__Value.equals(@'not_a_valid_os_caption', Set { StringComparison::ignoreCase } ) )))) or ((($GLOBAL_Platform_Settings_Win32_OperatingSystem_Version_Version__Value &gt;= Version{'10.0'}) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_OSType__Value = 18) and ($GLOBAL_Platform_Settings_Win32_OperatingSystem_ProductType__Value = 1) and ($GLOBAL_Platform_Settings_CCM_OperatingSystem_Architecture__Value.equalsIgnoreCase(@'X86')) and (not( $GLOBAL_Platform_Settings_Win32_OperatingSystem_OSCaption__Value.equals(@'not_a_valid_os_caption', Set { StringComparison::ignoreCase } ) ))))";
				Variables = 
				{
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_Win32_OperatingSystem_Version_Version__Value";
						Selector = "wmi::root::cimv2::Win32_OperatingSystem.instance().version.oclAsType(Version)";
						Changeable = False;
					}
					,
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_Win32_OperatingSystem_OSType__Value";
						Selector = "wmi::root::cimv2::Win32_OperatingSystem.instance().OSType";
						Changeable = False;
					}
					,
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_Win32_OperatingSystem_ProductType__Value";
						Selector = "wmi::root::cimv2::Win32_OperatingSystem.instance().ProductType";
						Changeable = False;
					}
					,
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_CCM_OperatingSystem_Architecture__Value";
						Selector = "wmi::root::CCM::CIModels::CCM_OperatingSystem.instance().Architecture";
						Changeable = False;
					}
					,
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_Win32_OperatingSystem_OSCaption__Value";
						Selector = "wmi::root::cimv2::Win32_OperatingSystem.instance().Caption";
						Changeable = False;
					}
					,
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "GLOBAL_Platform_Settings_Win32_OperatingSystem_OperatingSystemSKU__Value";
						Selector = "wmi::root::cimv2::Win32_OperatingSystem.instance().OperatingSystemSKU";
						Changeable = False;
					}
				};
			};
			Name = "Discovery_Rule_ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3";
		}
	};
};

#pragma namespace("\\\\.\\root\\microsoft\\PolicyPlatform\\Documents\\Local")

instance of PolicyPlatform_Policy
{
	Authority = "System Center Configuration Manager";
	CreationDate = "99991231235959.999999+000";
	ExportedRuleName = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Configuration_PolicyDocument";
	Name = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Configuration_PolicyDocument";
	Revision = 3;
	Rules =
	{
		instance of PolicyPlatform_Rule
		{
			Conditions = NULL;
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Invariant = "true";
				Variables = NULL;
			};
			Name = "5fed7d11_23e5_46ef_9648_ec05eb82e271__ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_Configuration_PolicyDocument";
		}
		,
		instance of PolicyPlatform_Rule
		{
			Conditions =
			{
				instance of PolicyPlatform_PolicyReference
				{
					Authority = "System Center Configuration Manager";
					PolicyName = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_Discovery_PolicyDocument";
				}
			};
			Goal = instance of PolicyPlatform_DesiredStateGoal
			{
				Contexts = 
				{
					instance of PolicyPlatform_Context
					{
						Quantifier = 1;
						Name = "Rule_6dfed4cf_b382_4902_9ce9_ccacda213b08_Context_1";
						Selector = "wmi::root::CCM::CIModels::ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50.allInstances()";
					}
				};
				Invariant = "$ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50__Value = false";
				Variables = 
				{
					instance of PolicyPlatform_ConfigPointVariable
					{
						Name = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_3_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50__Value";
						ContextName = "Rule_6dfed4cf_b382_4902_9ce9_ccacda213b08_Context_1";
						Selector = "Value";
						Changeable = True;
					}
				};
			};
			Name = "Rule_6dfed4cf_b382_4902_9ce9_ccacda213b08";
		}
	};
};

</data>
    </document>
    <document documentType="6">
      <docinfo>
        <WmiInstances xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2008/05/01/CIManifest">
          <WmiInstance WmiNamespace="root\CCM\CIModels">CCM_Script_Setting_Synclet.ID="ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50"</WmiInstance>
        </WmiInstances>
      </docinfo>
      <data>#pragma namespace("\\\\.\\root\\CCM\\CIModels")
Instance of CCM_Script_Setting_Synclet
{
	ID = "ScopeId_96966290_7C86_45F7_9623_B88938BD645D_OperatingSystem_bdf0dffe_e482_4583_93a3_18d3fc6767db_ScriptSetting_bffabb8f_4a67_4f41_9be6_c1099216bb50";
	Use64BitScriptingHost = TRUE;
	DataType = 11;
	DiscoveryScript = instance of ScriptDefinition
	{
		ScriptType = 0;
		ScriptBody = "&lt;#	\n	.NOTES\n	===========================================================================\n	 Created with: 	SAPIEN Technologies, Inc., PowerShell Studio 2021 v5.8.188\n	 Created on:   	05/05/2021 18:15\n	 Created by:   	MauriceDaly\n	 Organization: 	Cloudway\n	 Filename:     	Detect-CVE202121551-CM.ps1\n	===========================================================================\n	.DESCRIPTION\n		Searches for dbutil_2_3.sys assoicated with Dell CVE-2021-21551\n#&gt;\n\nfunction DetectCVEIssue {\n	$SystemFile = \"dbutil_2_3.sys\"\n	$UserProfileSearch = (Get-ChildItem -Path C:\\Users -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)\n	$TempSearch = (Get-ChildItem -Path C:\\Windows\\Temp -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)\n	if ([boolean]$UserProfileSearch -eq $true -or [boolean]$TempSearch -eq $true) {\n		Return $True\n	} else {\n		Return $False\n	}\n}\n\nDetectCVEIssue";
	};
	RemediationScript = instance of ScriptDefinition
	{
		ScriptType = 0;
		ScriptBody = "&lt;#	\n	.NOTES\n	===========================================================================\n	 Created with: 	SAPIEN Technologies, Inc., PowerShell Studio 2021 v5.8.188\n	 Created on:   	05/05/2021 18:15\n	 Created by:   	MauriceDaly\n	 Organization: 	Cloudway\n	 Filename:     	Remove-CVE202121551-CM.ps1\n	===========================================================================\n	.DESCRIPTION\n		Searches for and removes dbutil_2_3.sys assoicated with Dell CVE-2021-21551\n#&gt;\n\nfunction RemediateCVEIssue {\n	$SystemFile = \"dbutil_2_3.sys\"\n	$UserProfileSearch = (Get-ChildItem -Path C:\\Users -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)\n	$TempSearch = (Get-ChildItem -Path C:\\Windows\\Temp -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)\n	if ([boolean]$UserProfileSearch -eq $true -or [boolean]$TempSearch -eq $true) {\n		Write-Output \"Dell dbutil_2_3.sys file has been detected\"\n		if (-not ([string]::IsNullOrEmpty($UserProfileSearch.FullName))) {\n			foreach ($File in $UserProfileSearch.FullName) {\n				Remove-Item -Path $File -Verbose\n				Write-Output \"Removed Dell $SystemFile from $File\"\n			}\n		}\n		if (-not ([string]::IsNullOrEmpty($TempSearch.FullName))) {\n			foreach ($File in $TempSearch.FullName) {\n				Remove-Item -Path $File -Verbose\n				Write-Output \"Removed Dell $SystemFile from $File\"\n			}\n		}\n	} else {\n		Write-Output \"Dell dbutil_2_3.sys file not present on system\"\n	}\n}\n\nRemediateCVEIssue";
	};
};

</data>
    </document>
    <document documentType="0">
      <docinfo />
      <data>
        <DesiredConfigurationDigest xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/07/10/DesiredConfiguration">
          <!--Authored against the following schema version: 5-->
          <OperatingSystem AuthoringScopeId="ScopeId_96966290-7C86-45F7-9623-B88938BD645D" LogicalName="OperatingSystem_bdf0dffe-e482-4583-93a3-18d3fc6767db" Version="3">
            <Annotation xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
              <DisplayName Text="Dell CVE CVE-2021-21551 Issue" ResourceId="ID-e45e2e94-4a41-4252-9e31-4c0fe7552214" />
              <Description Text="" />
            </Annotation>
            <Parts>
              <SuppressionReferences />
            </Parts>
            <Settings>
              <RootComplexSetting>
                <SimpleSetting LogicalName="ScriptSetting_bffabb8f-4a67-4f41-9be6-c1099216bb50" DataType="Boolean">
                  <Annotation xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
                    <DisplayName Text="CVE CVE-2021-21551 Detection" ResourceId="ID-12288c61-6890-4ec8-80d3-ed663ed481d9" />
                    <Description Text="" />
                  </Annotation>
                  <ScriptDiscoverySource Is64Bit="true">
                    <DiscoveryScriptBody ScriptType="PowerShell">&lt;#	
	.NOTES
	===========================================================================
	 Created with: 	SAPIEN Technologies, Inc., PowerShell Studio 2021 v5.8.188
	 Created on:   	05/05/2021 18:15
	 Created by:   	MauriceDaly
	 Organization: 	Cloudway
	 Filename:     	Detect-CVE202121551-CM.ps1
	===========================================================================
	.DESCRIPTION
		Searches for dbutil_2_3.sys assoicated with Dell CVE-2021-21551
#&gt;

function DetectCVEIssue {
	$SystemFile = "dbutil_2_3.sys"
	$UserProfileSearch = (Get-ChildItem -Path C:\Users -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)
	$TempSearch = (Get-ChildItem -Path C:\Windows\Temp -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)
	if ([boolean]$UserProfileSearch -eq $true -or [boolean]$TempSearch -eq $true) {
		Return $True
	} else {
		Return $False
	}
}

DetectCVEIssue</DiscoveryScriptBody>
                    <RemediationScriptBody ScriptType="PowerShell">&lt;#	
	.NOTES
	===========================================================================
	 Created with: 	SAPIEN Technologies, Inc., PowerShell Studio 2021 v5.8.188
	 Created on:   	05/05/2021 18:15
	 Created by:   	MauriceDaly
	 Organization: 	Cloudway
	 Filename:     	Remove-CVE202121551-CM.ps1
	===========================================================================
	.DESCRIPTION
		Searches for and removes dbutil_2_3.sys assoicated with Dell CVE-2021-21551
#&gt;

function RemediateCVEIssue {
	$SystemFile = "dbutil_2_3.sys"
	$UserProfileSearch = (Get-ChildItem -Path C:\Users -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)
	$TempSearch = (Get-ChildItem -Path C:\Windows\Temp -Filter $SystemFile -Recurse -ErrorAction SilentlyContinue)
	if ([boolean]$UserProfileSearch -eq $true -or [boolean]$TempSearch -eq $true) {
		Write-Output "Dell dbutil_2_3.sys file has been detected"
		if (-not ([string]::IsNullOrEmpty($UserProfileSearch.FullName))) {
			foreach ($File in $UserProfileSearch.FullName) {
				Remove-Item -Path $File -Verbose
				Write-Output "Removed Dell $SystemFile from $File"
			}
		}
		if (-not ([string]::IsNullOrEmpty($TempSearch.FullName))) {
			foreach ($File in $TempSearch.FullName) {
				Remove-Item -Path $File -Verbose
				Write-Output "Removed Dell $SystemFile from $File"
			}
		}
	} else {
		Write-Output "Dell dbutil_2_3.sys file not present on system"
	}
}

RemediateCVEIssue</RemediationScriptBody>
                  </ScriptDiscoverySource>
                </SimpleSetting>
              </RootComplexSetting>
            </Settings>
            <Rules>
              <Rule xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules" id="Rule_6dfed4cf-b382-4902-9ce9-ccacda213b08" Severity="None" NonCompliantWhenSettingIsNotFound="false">
                <Annotation>
                  <DisplayName Text="Dell CVE-2021-21551 Compliance" ResourceId="ID-1a7bb693-baa2-4c7e-9ca9-0392313147dd" />
                  <Description Text="" />
                </Annotation>
                <Expression>
                  <Operator>Equals</Operator>
                  <Operands>
                    <SettingReference AuthoringScopeId="ScopeId_96966290-7C86-45F7-9623-B88938BD645D" LogicalName="OperatingSystem_bdf0dffe-e482-4583-93a3-18d3fc6767db" Version="3" DataType="Boolean" SettingLogicalName="ScriptSetting_bffabb8f-4a67-4f41-9be6-c1099216bb50" SettingSourceType="Script" Method="Value" Changeable="true" />
                    <ConstantValue Value="False" DataType="Boolean" />
                  </Operands>
                </Expression>
              </Rule>
            </Rules>
            <OperatingSystemDiscoveryRule xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
              <OperatingSystemExpression>
                <Operator>OneOf</Operator>
                <Operands>
                  <RuleExpression RuleId="Windows/All_ARM64_Windows_10_and_higher_Clients" />
                  <RuleExpression RuleId="Windows/All_MultiSession_Enterprise_Windows_10_higher" />
                  <RuleExpression RuleId="Windows/All_x64_Windows_10_and_higher_Clients" />
                  <RuleExpression RuleId="Windows/All_x86_Windows_10_and_higher_Clients" />
                </Operands>
              </OperatingSystemExpression>
            </OperatingSystemDiscoveryRule>
          </OperatingSystem>
        </DesiredConfigurationDigest>
      </data>
    </document>
  </instances>
</model>